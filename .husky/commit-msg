#!/usr/bin/env bash
# commit-msg hook: Block AI attribution in commit messages
# This enforces the Zero AI References in Commits convention
#
# To bypass (emergency only): git commit --no-verify

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Patterns to block (case-insensitive)
AI_PATTERNS=(
  "Generated with Claude"
  "Co-Authored-By: Claude"
  "Co-Authored-By:.*Anthropic"
  "AI-generated"
  "AI generated"
  "Generated by AI"
  "Generated by Claude"
  "Generated by GPT"
  "Generated by LLM"
  "ðŸ¤–"
)

for pattern in "${AI_PATTERNS[@]}"; do
  if echo "$COMMIT_MSG" | grep -iqE "$pattern"; then
    echo ""
    echo "ERROR: Commit message contains AI attribution pattern: '$pattern'"
    echo ""
    echo "This project has a zero-tolerance policy for AI references in commits."
    echo "Please remove AI attribution and write a clean commit message."
    echo ""
    echo "See: docs/wiki/Conventions/Git-Workflow.md"
    echo ""
    echo "To bypass (emergency only): git commit --no-verify"
    exit 1
  fi
done

exit 0
